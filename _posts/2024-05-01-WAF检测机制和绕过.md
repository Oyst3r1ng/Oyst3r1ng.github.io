---
layout: mypost
title: "WAF检测机制和绕过"
categories: [web安全]
---

## WAF的分类

针对于不同的WAF设备，绕过的手法也是不同的，分为硬件型WAF、云WAF、软件型WAF、自写规则的防护代码。

1. 硬件型WAF

硬件型WAF通常由厂商提供，作为物理设备通过安装到网络链路中进行防护。它直接部署在内网的交换机或者路由器上，对传入和传出的网络流量进行检查。

```
     ┌────────────────────┐
     │   内网交换机/路由器   │
     └────────────────────┘
             │
             ▼
    ┌──────────────────────┐
    │    硬件型 WAF        │
    └──────────────────────┘
             │
             ▼
    ┌──────────────────────┐
    │   Web服务器          │
    └──────────────────────┘

```

2. 云WAF

云WAF是通过云服务提供商提供的WAF服务，部署在云端，不需要企业自行管理硬件设备。它通常通过配置域名解析（如NS记录或CNAME记录）使得网站的流量先经过云WAF，再转发到实际的服务器。出名一点的长亭的雷池，它有三种部署模式，不管哪一种部署模式其实都是相当于做了一层反向代理和流量的转发

3. 软件型WAF

4. 自写规则防护代码



## WAF的工作原理



1. 预处理，一条流量过来会先经过WAF，然后才会到达网站服务器