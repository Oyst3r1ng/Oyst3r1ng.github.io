---
layout: mypost
title: "åˆ©ç”¨æµé‡æ£€æµ‹æŠ€æœ¯é˜²èŒƒä»»æ„æ–‡ä»¶è¯»å–æ¼æ´"
categories: [Webå®‰å…¨]
---

## å‰è¨€

å·¥ä½œéœ€è¦ï¼Œè®°å½•ğŸ“å­¦ä¹ ï¼Œå…ˆä» Arbitrary File Read Vulnerabilities åˆ†æå§ã€‚

## å‡†å¤‡å·¥ä½œ

1. Suricata 7.0.8
2. ç†Ÿæ‚‰ pcreã€ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´çš„åŸç†

## æ”»

å¸¦å…¥æ”»å‡»è€…è§†è§’ï¼Œç›®å‰æœ‰ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä»–ä¼šå»è¯»å“ªäº›ä¸œè¥¿ï¼ˆç›´ç™½ç‚¹å°±æ˜¯æ”»å‡»è€…å­—å…¸ä¸­çš„å†…å®¹ï¼‰ï¼Ÿ

1. åˆ©ç”¨ç»å¯¹è·¯å¾„ or ç›¸å¯¹è·¯å¾„ï¼Œå¦‚`../`ã€`./`ï¼Œä»¥åŠå®ƒçš„ç¼–ç å½¢å¼ï¼Œå¦‚`%2e%2e%2f`ã€`%252e%252e%252f`ï¼ˆç»•è¿‡é˜²æŠ¤ï¼‰å»è¯»å–ç½‘ç«™æºç æ–‡ä»¶ï¼Œç›®çš„æ˜¯å»è¯»åˆ°å…³é”®æ€§çš„ä¿¡æ¯ï¼ˆæ•°æ®åº“é…ç½®æ–‡ä»¶ã€å¯†é’¥ã€ç”šè‡³Passwdï¼‰ã€‚
2. è¯»å–æœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œå¦‚`/etc/passwd`ã€`/etc/hosts`ã€`/root/.bash_history`ç­‰ç­‰è¿™æ ·çš„ï¼Œè‹¥åç«¯å¼€å‘è¯­è¨€ä¸ºJavaä¼šå»è¯»ï¼Œè‹¥ä¸ºPHPæ¯«æ— ç–‘é—®ä¼šå»è¯»`php.ini`ç­‰ç­‰ã€‚
3. è‹¥åç«¯è¯­è¨€ä¸ºPHPï¼Œå¿…ç„¶ä¼šæµ‹çš„å°±æ˜¯ä¼ªåè®®ï¼Œä¾‹å¦‚`file://`ã€`php://`ã€`zip://`ã€`http://`ç­‰ç­‰ï¼Œåç«¯è¯­è¨€ä¸ºJavaçš„è¯ä¼šå»æµ‹æµ‹`jar`ç­‰ç­‰ã€‚
4. è¿˜æœ‰ä¸€äº›åœ¨å­—å…¸ä¸­é«˜é¢‘å‡ºç°çš„åç¼€`.jar`ï¼Œ`.tar.gz`ï¼Œ`.zip`ç­‰ç­‰ã€‚
5. å¾ˆç«çš„äº‘å®‰å…¨ï¼Œäº‘ä¸å®¹å™¨ç›¸å…³ï¼Œä¾‹å¦‚AWSå…ƒæ•°æ®ã€å®¹å™¨ç¯å¢ƒä¿¡æ¯ã€‚

å¥½å¤šå¥½å¤šPayloadï¼Œè¿™é‡ŒæŠŠå®ƒæ³›åŒ–ä¸ºå››å¤§ç±»-->è·¯å¾„ç©¿è¶ŠåŠç»•è¿‡æŠ€å·§ã€è¯»å–ç‰¹å®šçš„æ•æ„Ÿæ–‡ä»¶ï¼ˆOSç‰¹å®šçš„ã€å¼€å‘æ¡†æ¶ç‰¹å®šçš„ã€äº‘ä¸å®¹å™¨ç›¸å…³çš„ç­‰ç­‰ï¼‰ã€ä¼ªåè®®ä¸ç‰¹æ®Šåè®®ã€æ–‡ä»¶ååç¼€ã€‚

## å®ˆ

è®¾è®¡å¥½ä¸€ä¸ªyamlè§„åˆ™é…ç½®æ–‡ä»¶å¦‚ä¸‹

```yaml
patterns:
  paths:
    - (?:(?:%2e|%252e|\.\.|\.){1,}(?:%2f|%252f|\/|\\){1,}){1,2}
    - (?:\\x[0-9a-f]{2}){1,2}

  files:
    os:
      - \/etc\/passwd
      - \\boot\.ini
      - \/\.ssh\/id_rsa
      - \/\.bash_history
      - \/etc\/hosts
    framework:
      - \/etc\/php\/php\.ini
      - web\.xml
      - \/etc\/nginx\/nginx\.conf

  protocols:
    - (?:file:\/\/|php:\/\/|zip:\/\/|http:\/\/)

  extensions:
    - [^&]*\.(?:tar\.gz|jar|db|bak)
```

```pcre
/parm=(?:(?:file|php|zip|http):\/\/|[^&=]*?(?:(?:(?:\.\.|\.|%2e|%252e){1,}(?:\/|\\|%2f|%252f){1,}){1,2}|(?:\\x[0-9a-f]{2}){1,2}|[^&=]*\/(?:etc\/passwd|\.ssh\/id_rsa|\.bash_history|etc\/hosts|etc\/php\/php\.ini|etc\/nginx\/nginx\.conf)|\\boot\.ini|web\.xml|[^&=.]++\.(?:tar\.gz|jar|db|bak)))/
```


alert http any any -> any any ( msg:"SeaCMS admin_safe_fileæ¥å£ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2025-25800ï¼ˆupdateï¼‰"; flow:to_server,established; http.uri; content:"/admin_safe_file.php"; nocase; content:"file="; nocase; pcre:"/file=(?:(?:(?:%2e|%252e|\.\.|\.){1,2}(?:%2f|%252f|\/|\\)){2,}|(?:\\x[0-9a-f]{2}){3,}|\/etc\/shadow|.*\/etc\/passwd|\\boot\.ini|\/.*\/\.ssh\/id_rsa|\/.*\/\.ssh\/id_rsa\.pub|\/etc\/ssh\/sshd_config|\/.*\/\.ssh\/authorized_keys|\\Windows\\System32\\drivers\\etc\\hosts|\/proc\/self\/environ|\/.*\/\.bash_history|\/etc\/hosts|\/proc\/self\/fd\/.*|\/proc\/net\/.*|\/etc\/profile|tomcat-users\.xml|web\.xml\b|\.env\b|config\.(?:js|py|php)|\/etc\/nginx\/nginx\.conf|\/etc\/apache2\/apache2\.conf|catalina\.sh\b|\/proc\/self\/environ|\/var\/run\/docker\.sock|\/var\/run\/secrets\/kubernetes\.io\/serviceaccount\/token|phar:\/\/|file:\/{1,3}|php:\/\/|\.bak\b|\.sql\b|\.pem\b|\.tar\.gz$|\.yaml$|\.db$|\.jar$)/"; sid:1; rev:1; )

alert http any any -> any any ( msg:"SeaCMS admin_safe_fileæ¥å£ ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ CVE-2025-25800ï¼ˆoriginalï¼‰"; flow:to_server,established; http.uri; content:"/admin_safe_file.php"; nocase; content:"file="; nocase; pcre:"/file=(?:(?:file|php|zip|http):\/\/|[^&=]*?(?:(?:(?:\.\.|\.|%2e|%252e){1,}(?:\/|\\|%2f|%252f){1,}){1,2}|(?:\\x[0-9a-f]{2}){1,2}|[^&=]*\/(?:etc\/passwd|\.ssh\/id_rsa|\.bash_history|etc\/hosts|etc\/php\/php\.ini|etc\/nginx\/nginx\.conf)|\\boot\.ini|web\.xml|[^&=.]++\.(?:tar\.gz|jar|db|bak)))/"; sid:2; rev:1; )
é’ˆå¯¹äºæœ‰åç¼€çš„ï¼š[^&=.]++æœ€å¿«

















